<app-protein-domain
  [loading]="loading"
  [gene]="gene"
  [data]="domainData"
  (highlight)="highlightDomain($event); scrollToAlignment()"
></app-protein-domain>

<h3 class="mt-5 mb-0">
  Multiple Protein Alignment for {{ gene? gene.symbol : '' }}&nbsp;
  <span class="badge badge-secondary" style="font-size: 0.4em; vertical-align: middle;">DIOPT v7.1</span>
</h3>

<div id="alignment-highlight" class="row mt-3" *ngIf="!loading && data && species">
  <div class="col-12" style="margin-bottom: -1.25em">
    Highlight from
    <mat-form-field>
      <input matInput type="number" [value]="highlightFrom" (change)="setHighlightFrom($event.target.value)">
    </mat-form-field>
    to
    <mat-form-field>
      <input matInput type="number" [value]="highlightTo" (change)="setHighlightTo($event.target.value)">
    </mat-form-field>
  </div>
  <div class="col-12 mt-3">
      Highlight for&nbsp;
      <mat-slide-toggle
        *ngFor="let speciesTag of species"
        [matTooltip]="speciesTagToName[speciesTag]"
        [(ngModel)]="speciesToHighlight[speciesTag]"
        color="primary"
        class="mr-3"
      >{{ speciesTag }}</mat-slide-toggle>
  </div>
</div>

<div class="mt-3 w-100 text-monospace" style="overflow-x: scroll; font-size: 0.9em;"
  *ngIf="!loading && data"
>
  <div *ngFor="let row of data" style="width: 950px">
    <div *ngIf="row.species !== 'mark' && row.display">
      <div class="species-tag d-inline-block align-middle">
        <span>{{ row.species }}{{ row.sIdx }}</span>
      </div>
      <span
        class="d-inline-block"
        *ngFor="let protein of row['proteins']; let idx = index"
        [style]="getStyle(row['style'][idx])"
        [ngClass]="{ 'text-highlight': speciesToHighlight[row.species] && highlightFrom <= row.realIdx[idx] && row.realIdx[idx] <= highlightTo }"
      >{{ protein }}</span>
      <span class="ml-2">[{{ row.endIdx }}]</span>
    </div>

    <div class="mb-2" *ngIf="row.species === 'mark'">
      <div class="species-tag d-inline-block align-middle">&nbsp;</div>
      <span class="">{{ row.mark.substr(4) }}</span>
    </div>

  </div>
</div>

<div class="mt-3" *ngIf="!loading && !data">
  <p>No matches found</p>
</div>